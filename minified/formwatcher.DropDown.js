/*  Â© Matias Meno   */(function(a){var b=Formwatcher.Class.extend({init:function(b,c,d,e){this.watcher=b,this.elements=c,this.options=d,this.selectedOptionIdx=e,c.button.click(_.bind(this.toggleList,this
));var f=this;a("a",c.list).click(function(){f.selectedOption(a(this).fwData("optionIdx"))}),this.updateState()},toggleList:function(){this.elements.list.is(":hidden")?this.showList():this.hideList()},
showList:function(){this.elements.list.show();var b=a("li.selected",this.elements.list);b.size()&&this.elements.list.scrollTop(this.elements.list.scrollTop()+b.position().top-15);var c=this;_.defer(function(
){c.elements.list.outerClick(_.bind(c.hideList,c),"hiding")})},hideList:function(){this.elements.list.hide(),this.elements.list.unbindOuterClick("hiding")},selectedOption:function(a){this.selectedOptionIdx=
a;var b=this.getSelectedOption();this.elements.button.html(b.name),this.hideList(),this.elements.input.val(b.value),this.updateState(),Formwatcher.changed(this.elements,this.watcher)},updateState:function(
){var b=this.getSelectedOption();b&&(this.elements.button.html(b.name),a("li.selected",this.elements.list).removeClass("selected"),_.any(a("li",this.elements.list),function(b){return b=a(b),a("a",b).fwData
("optionIdx")==this.selectedOptionIdx?(b.addClass("selected"),!0):!1},this))},getSelectedOption:function(){return this.selectedOptionIdx===null?null:this.options[this.selectedOptionIdx]}});Formwatcher.
Decorators.push(Formwatcher.Decorator.extend({name:"DropDown",description:"Converts a select into a button, which shows a div of all available options when clicked. This is ment to facilitate designing drop downs."
,nodeNames:["SELECT"],classNames:["drop-down"],decorate:function(c){var d=a.el("input").attr("name",c.attr("name")||"").attr("type","hidden").val(c.val()),e=[],f="",g;a("option",c).each(function(b){var d=
a(this);e[b]={value:d.val(),name:d.html()},d.val()==c.val()&&(g=b,f=d.html())});var h=this.createButtonElement(f),i=this.createListElement(e),j=a.el("div").addClass("drop-down").append(h).append(i).append
(d).insertAfter(c);return c.remove(),elements={input:d,button:h,list:i},new b(this.watcher,elements,e,g),elements},createButtonElement:function(b){return a.el("button").attr("type","button").html(b)},createListElement
:function(b,c){var d=a.el("div").addClass("list").hide(),e=a.el("ul").appendTo(d);return _.each(b,function(b,d){if(c||b.value!=""){var f=a.el("li"),g=a.el("a").attr("href","javascript:undefined;").html
(b.name).fwData("value",b.value).fwData("optionIdx",d).appendTo(f);e.append(f)}}),d}}))})(jQuery);